# æµ‹è¯•æ–‡ä»¶ç›®å½•

æœ¬ç›®å½•åŒ…å«Smart Payment Checkoutåç«¯çš„æ‰€æœ‰æµ‹è¯•æ–‡ä»¶ã€‚

## ğŸ“‹ æµ‹è¯•æ–‡ä»¶åˆ—è¡¨

### test_3ds_fix.py
**ç›®çš„ï¼š** æµ‹è¯•3DSéªŒè¯æµç¨‹ä¿®å¤
**æµ‹è¯•å†…å®¹ï¼š**
- 3DSéªŒè¯å¯åŠ¨æµç¨‹
- äº¤æ˜“æ•°æ®å­˜å‚¨å’Œæ£€ç´¢
- 3DSéªŒè¯å®Œæˆåçš„æ”¯ä»˜å¤„ç†
- äº¤æ˜“æ•°æ®å®Œæ•´æ€§éªŒè¯

**è¿è¡Œæ–¹å¼ï¼š**
```bash
uv run python tests/test_3ds_fix.py
```

### test_field_rules.py
**ç›®çš„ï¼š** æµ‹è¯•åŸºäºå­—æ®µçš„é£é™©è§„åˆ™
**æµ‹è¯•å†…å®¹ï¼š**
- å¤§é¢äº¤æ˜“è§„åˆ™
- æ–°ç”¨æˆ·è§„åˆ™
- è·¨å¢ƒäº¤æ˜“è§„åˆ™
- è‡ªå®šä¹‰å­—æ®µè§„åˆ™

**è¿è¡Œæ–¹å¼ï¼š**
```bash
uv run python tests/test_field_rules.py
```

### test_llm_without_3ds.py
**ç›®çš„ï¼š** æµ‹è¯•LLMåˆ†æä½†ä¸è§¦å‘3DSéªŒè¯
**æµ‹è¯•å†…å®¹ï¼š**
- é£é™©åˆ†æ•°30-40çš„äº¤æ˜“
- LLMåˆ†æè§¦å‘
- 3DSéªŒè¯ä¸è§¦å‘
- è¾¹ç•Œæƒ…å†µæµ‹è¯•

**è¿è¡Œæ–¹å¼ï¼š**
```bash
uv run python tests/test_llm_without_3ds.py
```

### test_risk_check.py
**ç›®çš„ï¼š** æµ‹è¯•é£é™©æ£€æŸ¥åŠŸèƒ½
**æµ‹è¯•å†…å®¹ï¼š**
- é£é™©è¯„åˆ†è®¡ç®—
- é£é™©ç­‰çº§ç¡®å®š
- è§„åˆ™åº”ç”¨é€»è¾‘
- é˜ˆå€¼éªŒè¯

**è¿è¡Œæ–¹å¼ï¼š**
```bash
uv run python tests/test_risk_check.py
```

### test_risk_local.py
**ç›®çš„ï¼š** æœ¬åœ°é£é™©æµ‹è¯•ï¼ˆæ— éœ€APIï¼‰
**æµ‹è¯•å†…å®¹ï¼š**
- æœ¬åœ°é£é™©è¯„ä¼°
- è§„åˆ™é…ç½®éªŒè¯
- é£é™©åˆ†æ•°è®¡ç®—

**è¿è¡Œæ–¹å¼ï¼š**
```bash
uv run python tests/test_risk_local.py
```

### test_risk_service.py
**ç›®çš„ï¼š** æµ‹è¯•é£é™©æœåŠ¡æ¨¡å—
**æµ‹è¯•å†…å®¹ï¼š**
- risk_checkå‡½æ•°
- verify_3dså‡½æ•°
- validate_3ds_codeå‡½æ•°
- æœåŠ¡é›†æˆæµ‹è¯•

**è¿è¡Œæ–¹å¼ï¼š**
```bash
uv run python tests/test_risk_service.py
```

## ğŸ§ª è¿è¡Œæ‰€æœ‰æµ‹è¯•

### Windows PowerShell
```powershell
cd tests
Get-ChildItem test_*.py | ForEach-Object { uv run python $_.Name }
```

### Linux/Mac
```bash
cd tests
for file in test_*.py; do uv run python "$file"; done
```

## ğŸ“Š æµ‹è¯•è¦†ç›–èŒƒå›´

| æµ‹è¯•æ–‡ä»¶ | é£é™©è¯„ä¼° | 3DSéªŒè¯ | LLMåˆ†æ | APIé›†æˆ | æœ¬åœ°æµ‹è¯• |
|---------|---------|---------|---------|---------|---------|
| test_3ds_fix.py | âœ“ | âœ“ | âœ— | âœ“ | âœ— |
| test_field_rules.py | âœ“ | âœ— | âœ— | âœ— | âœ“ |
| test_llm_without_3ds.py | âœ“ | âœ“ | âœ“ | âœ“ | âœ— |
| test_risk_check.py | âœ“ | âœ— | âœ— | âœ— | âœ“ |
| test_risk_local.py | âœ“ | âœ— | âœ— | âœ— | âœ“ |
| test_risk_service.py | âœ“ | âœ“ | âœ— | âœ— | âœ“ |

## ğŸ”§ æµ‹è¯•ç¯å¢ƒè¦æ±‚

### å¿…éœ€ä¾èµ–
- Python 3.10+
- uv (åŒ…ç®¡ç†å™¨)
- FastAPI
- requests (ç”¨äºAPIæµ‹è¯•)

### è¿è¡ŒæœåŠ¡å™¨
å¤§å¤šæ•°æµ‹è¯•éœ€è¦åç«¯æœåŠ¡å™¨è¿è¡Œï¼š

```bash
# åœ¨backendç›®å½•ä¸‹
uv run uvicorn app:app --reload
```

### é…ç½®ç¯å¢ƒå˜é‡
æŸäº›æµ‹è¯•éœ€è¦APIå¯†é’¥é…ç½®ï¼š

```bash
cp .env.example .env
# ç¼–è¾‘.envæ–‡ä»¶æ·»åŠ å¿…è¦çš„é…ç½®
```

## ğŸ“ æµ‹è¯•æœ€ä½³å®è·µ

1. **ç‹¬ç«‹è¿è¡Œï¼š** æ¯ä¸ªæµ‹è¯•åº”è¯¥ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•
2. **æ¸…ç†çŠ¶æ€ï¼š** æµ‹è¯•å®Œæˆåæ¸…ç†ä¸´æ—¶æ•°æ®å’ŒçŠ¶æ€
3. **æ¸…æ™°è¾“å‡ºï¼š** æµ‹è¯•ç»“æœåº”è¯¥æ¸…æ™°æ˜“è¯»
4. **é”™è¯¯å¤„ç†ï¼š** é€‚å½“çš„é”™è¯¯å¤„ç†å’Œå¤±è´¥æŠ¥å‘Š
5. **æ–‡æ¡£æ³¨é‡Šï¼š** æµ‹è¯•ä»£ç åº”è¯¥æœ‰æ¸…æ™°çš„æ³¨é‡Š

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šæµ‹è¯•æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨
**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®è®¤æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼š`curl http://127.0.0.1:8000/health`
2. æ£€æŸ¥ç«¯å£æ˜¯å¦æ­£ç¡®
3. éªŒè¯é˜²ç«å¢™è®¾ç½®

### é—®é¢˜ï¼šä¾èµ–ç¼ºå¤±
**è§£å†³æ–¹æ¡ˆï¼š**
```bash
uv sync
```

### é—®é¢˜ï¼šæµ‹è¯•å¤±è´¥ä½†ä»£ç çœ‹èµ·æ¥æ­£ç¡®
**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—
2. éªŒè¯é…ç½®æ–‡ä»¶ï¼ˆrules.jsonï¼‰
3. ç¡®è®¤ç¯å¢ƒå˜é‡è®¾ç½®

## ğŸ“ˆ æ·»åŠ æ–°æµ‹è¯•

### åˆ›å»ºæ–°æµ‹è¯•æ–‡ä»¶
1. åœ¨ `tests/` ç›®å½•åˆ›å»º `test_new_feature.py`
2. å¯¼å…¥å¿…è¦çš„æ¨¡å—
3. ç¼–å†™æµ‹è¯•å‡½æ•°
4. æ·»åŠ æ–‡æ¡£æ³¨é‡Š

### æµ‹è¯•æ¨¡æ¿
```python
"""
æµ‹è¯•æ–°åŠŸèƒ½
"""

import requests
import json

BASE_URL = "http://127.0.0.1:8000"

def test_new_feature():
    """æµ‹è¯•æ–°åŠŸèƒ½"""
    print("Testing new feature...")
    
    # æµ‹è¯•é€»è¾‘
    test_data = {
        # æµ‹è¯•æ•°æ®
    }
    
    response = requests.post(f"{BASE_URL}/endpoint", json=test_data)
    result = response.json()
    
    # éªŒè¯ç»“æœ
    if result.get("expected_field"):
        print("âœ“ Test passed")
        return True
    else:
        print("âœ— Test failed")
        return False

if __name__ == "__main__":
    test_new_feature()
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [../README.md](../README.md) - é¡¹ç›®ä¸»æ–‡æ¡£
- [../docs/](../docs/) - è¯¦ç»†æ–‡æ¡£ç›®å½•

## ğŸ¤ è´¡çŒ®

æ·»åŠ æ–°æµ‹è¯•æ—¶ï¼Œè¯·éµå¾ªä»¥ä¸‹å‡†åˆ™ï¼š
1. ä½¿ç”¨æè¿°æ€§çš„æ–‡ä»¶å
2. åŒ…å«æ¸…æ™°çš„æ–‡æ¡£æ³¨é‡Š
3. æä¾›è¿è¡Œè¯´æ˜
4. å¤„ç†é”™è¯¯æƒ…å†µ
5. è¿”å›æ˜ç¡®çš„æµ‹è¯•ç»“æœ

---

**æ³¨æ„ï¼š** è¿™äº›æµ‹è¯•ä¸»è¦ç”¨äºå¼€å‘å’Œæ¼”ç¤ºç›®çš„ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®ä½¿ç”¨ä¸“ä¸šçš„æµ‹è¯•æ¡†æ¶å¦‚pytestã€‚